<!doctype html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <title>Awesome Capacitor App</title>
    <meta
      name="viewport"
      content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />

    <script
      type="module"
      src="https://unpkg.com/@ionic/pwa-elements@latest/dist/ionicpwaelements/ionicpwaelements.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/@ionic/pwa-elements@latest/dist/ionicpwaelements/ionicpwaelements.js"
    ></script>

    <link rel="icon" type="image/x-icon" href="/assets/favicon-UvKAN7pv.ico" />
    <link rel="manifest" href="/assets/manifest-RD-sWVQA.json" />
    <meta name="theme-color" content="#31d53d" />
    <script type="module" crossorigin src="/assets/index-uYMN29pI.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/index-CKml3WWL.css">
  </head>
  <body>
    <!-- <capacitor-welcome></capacitor-welcome> -->
    
    <!-- Home Screen -->
    <div id="home-screen" class="screen active">
      <div id="title">CODetect</div>
      <button id="connect-btn" class="buttons">Connect to ESP32</button>
      <button id="escape-btn" class="buttons escape-btn">ğŸ—ºï¸ Escape Route Finder</button>
      <div class="device-instructions">
        <p>Make sure your ESP32 detector is powered on and in range</p>
      </div>
    </div>

    <!-- Device Picker Modal -->
    <div id="device-modal" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Select Device</h2>
          <button id="modal-close-btn" class="modal-close">âœ•</button>
        </div>
        <div class="modal-status" id="modal-status">Scanning for devices...</div>
        <div class="device-list" id="device-list"></div>
        <button id="show-more-btn" class="show-more-btn" style="display: none;">
          Show More Devices
        </button>
        <div class="modal-actions">
          <button id="rescan-btn" class="modal-btn secondary">ğŸ”„ Rescan</button>
          <button id="cancel-scan-btn" class="modal-btn secondary">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Monitor Screen -->
    <div id="monitor-screen" class="screen">
      <div class="monitor-header">
        <button id="back-btn" class="back-button">â† Back</button>
        <div class="monitor-title">Sensor Monitor</div>
      </div>
      <div class="monitor-container">
        <div class="sensor-card">
          <div class="sensor-icon">ğŸŒ¡ï¸</div>
          <div class="sensor-label">Temperature</div>
          <div class="sensor-value" id="temperature-value">--</div>
          <div class="sensor-unit">Â°C</div>
        </div>
        <div class="sensor-card">
          <div class="sensor-icon">ğŸ’§</div>
          <div class="sensor-label">Humidity</div>
          <div class="sensor-value" id="humidity-value">--</div>
          <div class="sensor-unit">%</div>
        </div>
        
        <!-- CO Sensor with GRU Prediction -->
        <div class="sensor-card co-card">
          <div class="sensor-icon">ğŸ’¨</div>
          <div class="sensor-label">Carbon Monoxide (CO)</div>
          <div class="co-data-table">
            <div class="co-row">
              <span class="co-label">Current:</span>
              <span class="co-value" id="co-current-value">--</span>
              <span class="co-unit">ppm</span>
            </div>
            <div class="co-row prediction-row">
              <span class="co-label">Predicted (GRU):</span>
              <span class="co-value predicted" id="co-predicted-value">--</span>
              <span class="co-unit">ppm</span>
            </div>
            <div class="prediction-info">
              <span class="prediction-horizon" id="prediction-horizon">Next 5 min forecast</span>
              <span class="model-status" id="model-status">ğŸ”„ Model loading...</span>
            </div>
          </div>
        </div>
      </div>
      <div class="connection-status" id="connection-status">Connecting...</div>
    </div>

    <!-- Escape Route Screen -->
    <div id="escape-screen" class="screen">
      <div class="monitor-header">
        <button id="escape-back-btn" class="back-button">â† Back</button>
        <div class="monitor-title">Escape Route Finder</div>
      </div>
      
      <div class="escape-container">
        <!-- Map Grid -->
        <div class="map-section">
          <div class="map-header">
            <span class="map-title">Building CO Levels Map</span>
            <button id="simulate-emergency-btn" class="emergency-btn">âš ï¸ Simulate Emergency</button>
          </div>
          <div class="map-grid" id="map-grid"></div>
          <div class="map-legend">
            <div class="legend-item"><span class="legend-color safe"></span> Safe (0-15 ppm)</div>
            <div class="legend-item"><span class="legend-color elevated"></span> Elevated (15-25 ppm)</div>
            <div class="legend-item"><span class="legend-color dangerous"></span> Dangerous (25-50 ppm)</div>
            <div class="legend-item"><span class="legend-color critical"></span> Critical (50+ ppm)</div>
            <div class="legend-item"><span class="legend-color wall"></span> Wall</div>
            <div class="legend-item"><span class="legend-color exit"></span> Exit</div>
            <div class="legend-item"><span class="legend-color path"></span> Safe Path</div>
          </div>
        </div>

        <!-- Controls -->
        <div class="path-controls">
          <div class="position-selector">
            <label>Your Position:</label>
            <div class="position-inputs">
              <input type="number" id="start-x" value="0" min="0" max="9" />
              <input type="number" id="start-y" value="0" min="0" max="9" />
              <button id="set-position-btn" class="small-btn">Set</button>
            </div>
          </div>
          <button id="find-path-btn" class="buttons find-path-btn">ğŸƒ Find Safest Exit</button>
        </div>

        <!-- Path Results -->
        <div class="path-results" id="path-results">
          <div class="results-header">Recommended Routes</div>
          <div class="results-list" id="results-list"></div>
        </div>

        <!-- CO Database Table -->
        <div class="database-section">
          <div class="db-header">
            <span>ğŸ“Š CO Levels Database</span>
            <button id="refresh-db-btn" class="small-btn">ğŸ”„ Refresh</button>
          </div>
          <div class="db-table-container">
            <table class="db-table" id="co-table">
              <thead>
                <tr>
                  <th>Zone</th>
                  <th>CO Level</th>
                  <th>Status</th>
                  <th>Updated</th>
                </tr>
              </thead>
              <tbody id="co-table-body"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

  </body>
</html>
